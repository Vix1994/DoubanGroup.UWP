<Page
    x:Class="DoubanGroup.Client.Views.TopicDetailPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:DoubanGroup.Client.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:designData="using:DoubanGroup.Client.DesignData"
    xmlns:mvvm="using:Prism.Windows.Mvvm"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:behaviors="using:DoubanGroup.Client.Behaviors"
    mc:Ignorable="d"
    mvvm:ViewModelLocator.AutoWireViewModel="True"
    d:DataContext="{d:DesignInstance Type=designData:TopicDetailData, IsDesignTimeCreatable=True}">

    <Page.Resources>
        <DataTemplate x:Key="CommentDataTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <Image Source="{Binding Author.Avatar}" Style="{StaticResource SmallUserAvatarImageStyle}" Grid.RowSpan="2" VerticalAlignment="Top" Margin="0 0 10 0"/>

                <StackPanel Orientation="Horizontal" Grid.Column="1">
                    <TextBlock Text="{Binding Author.Name}"/>
                    
                    <TextBlock Text="{Binding Time, Converter={StaticResource DateTimeToStringConverter}}" Margin="10 0 0 0" Style="{StaticResource SecondaryTextBlockStyle}" VerticalAlignment="Center"/>
                </StackPanel>
                
                <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding Text}" TextWrapping="Wrap" Margin="0 10 0 0"/>
            </Grid>
        </DataTemplate>
    </Page.Resources>

    <GridView Padding="20 10" Background="{StaticResource DefaultBackground}" Style="{StaticResource DefaultGridViewStyle}" ItemsSource="{Binding CommentList}" ItemTemplate="{StaticResource CommentDataTemplate}">
        <i:Interaction.Behaviors>
            <behaviors:GridViewItemFitWidthBehavior MaxWidth="3000"/>
        </i:Interaction.Behaviors>
        <GridView.Header>
            <StackPanel>
                <StackPanel Margin="-20 -10 -20 0" Background="#FFFFFF" Padding="20 10">
                    <TextBlock Text="{Binding Topic.Title}" Style="{StaticResource TitleTextBlockStyle}"/>

                    <StackPanel Orientation="Horizontal" Margin="0 10 0 0">
                        <Image Source="{Binding Topic.Author.Avatar}" Width="40" Height="40"/>
                        <TextBlock Text="{Binding Topic.Author.Name}" Margin="10 0 0 0" VerticalAlignment="Center"/>
                    </StackPanel>

                    <TextBlock Margin="0 10 0 0" Text="{Binding Topic.Content}" TextWrapping="Wrap"></TextBlock>
                </StackPanel>

                <TextBlock Margin="0 10 0 0" Text="最赞回应" Style="{StaticResource SubtitleTextBlockStyle}"></TextBlock>

                <GridView Margin="0 10 0 0" Style="{StaticResource DefaultGridViewStyle}" ItemsSource="{Binding PopularCommentList}" ItemTemplate="{StaticResource CommentDataTemplate}">
                    <i:Interaction.Behaviors>
                        <behaviors:GridViewItemFitWidthBehavior MaxWidth="3000"/>
                    </i:Interaction.Behaviors>
                </GridView>

                <TextBlock Margin="0 0 0 10" Text="全部回应" Style="{StaticResource SubtitleTextBlockStyle}"></TextBlock>
            </StackPanel>
        </GridView.Header>
    </GridView>
</Page>
